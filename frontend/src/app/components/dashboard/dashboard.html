<div class="dashboard-container">
  <!-- Welcome Section -->
  <section class="welcome-section">
    <div class="welcome-card">
      <div class="user-avatar">
        {{ (currentUser?.profile?.firstName || currentUser?.email || 'U').charAt(0).toUpperCase() }}
      </div>
      <div class="welcome-text">
        <h1>Â¡Hola, {{ currentUser?.profile?.firstName || 'Usuario' }}!</h1>
        <p class="user-role">{{ currentUser?.role | titlecase }}</p>
      </div>
    </div>
  </section>

  <!-- Main Dashboard Grid -->
  <div class="dashboard-grid">
    <!-- Calendar Section -->
    <div class="calendar-section">
      <div class="section-header">
        <h2>ğŸ“… Mi Calendario</h2>
        <div class="calendar-actions">
          <button class="btn-new-appointment" routerLink="/app/appointments">+ Nueva Cita</button>
          <button 
            class="btn-google-sync" 
            (click)="connectGoogleCalendar()"
            *ngIf="!isGoogleConnected()">
            ğŸ“… Conectar Google Calendar
          </button>
          <button 
            class="btn-google-connected" 
            (click)="syncWithGoogleCalendar()"
            *ngIf="isGoogleConnected()">
            âœ… Sincronizar Google Calendar
          </button>
        </div>
      </div>
      
      <div class="calendar-container">
        <div class="calendar-header">
          <button class="nav-btn" (click)="previousMonth()" title="Mes anterior">
            â†
          </button>
          <div class="month-year-selector">
            <h3>{{ currentMonth }} {{ currentYear }}</h3>
            <button class="btn-today" (click)="goToToday()">Hoy</button>
          </div>
          <button class="nav-btn" (click)="nextMonth()" title="Mes siguiente">
            â†’
          </button>
        </div>
        
        <div class="calendar-wrapper">
          <div class="calendar-grid">
            <div class="day-header" *ngFor="let day of weekDays">{{ day }}</div>
            <div 
              class="calendar-day" 
              *ngFor="let day of calendarDays"
              [class.other-month]="!day.isCurrentMonth"
              [class.today]="day.isToday"
              [class.has-appointment]="day.hasAppointment"
              [class.weekend]="day.isWeekend"
              [class.selected]="selectedDate && day.date.toDateString() === selectedDate.toDateString()"
              (click)="onDateSelected(day)">
              <span class="day-number">{{ day.number }}</span>
              <div class="day-content">
                <div class="appointments" *ngIf="day.appointments?.length">
                  <div 
                    class="appointment-dot" 
                    *ngFor="let apt of day.appointments"
                    [class]="'apt-' + apt.type"
                    [title]="apt.title">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="selected-date-info" *ngIf="selectedDate">
          <h4>{{ selectedDate | date:'fullDate' }}</h4>
          <div class="day-appointments" *ngIf="getAppointmentsForSelectedDate().length > 0">
            <div class="appointment-item" *ngFor="let apt of getAppointmentsForSelectedDate()">
              <span class="apt-dot" [class]="'apt-' + apt.type"></span>
              <span>{{ apt.title }}</span>
            </div>
          </div>
          <p *ngIf="getAppointmentsForSelectedDate().length === 0" class="no-appointments-day">
            No hay citas programadas para este dÃ­a
          </p>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions-section">
      <h2>âš¡ Acciones RÃ¡pidas</h2>
      
      <div class="action-cards">
        <div *ngIf="currentUser?.role === 'patient'" class="action-card patient">
          <div class="card-icon">ğŸ‘¨â€âš•ï¸</div>
          <h3>Buscar Profesionales</h3>
          <p>Encuentra especialistas</p>
          <button class="btn-action" routerLink="/app/find-professionals">Explorar</button>
        </div>

        <div *ngIf="currentUser?.role === 'professional'" class="action-card professional">
          <div class="card-icon">ğŸ©º</div>
          <h3>Mi Agenda</h3>
          <p>Gestiona horarios</p>
          <button class="btn-action">Ver Agenda</button>
        </div>

        <div class="action-card">
          <div class="card-icon">ğŸ‘¤</div>
          <h3>Mi Perfil</h3>
          <p>Actualizar informaciÃ³n</p>
          <button class="btn-action" routerLink="/app/profile">Editar</button>
        </div>

        <div *ngIf="currentUser?.role === 'patient'" class="action-card patient">
          <div class="card-icon">ğŸ“…</div>
          <h3>Mis Turnos</h3>
          <p>Ver citas agendadas</p>
          <button class="btn-action" routerLink="/app/my-appointments">Ver Turnos</button>
        </div>

        <div *ngIf="currentUser?.role === 'patient'" class="action-card patient">
          <div class="card-icon">ğŸ“‹</div>
          <h3>Historial MÃ©dico</h3>
          <p>Ver expediente digital</p>
          <button class="btn-action" routerLink="/app/medical-history">Ver Historial</button>
        </div>

        <div *ngIf="currentUser?.role === 'admin'" class="action-card admin">
          <div class="card-icon">ğŸ‘¨âš•ï¸</div>
          <h3>Gestionar Profesionales</h3>
          <p>Registrar nuevos mÃ©dicos</p>
          <button class="btn-action" routerLink="/app/professionals">Gestionar</button>
        </div>
      </div>
    </div>

    <!-- Recent Appointments -->
    <div class="appointments-section">
      <h2>ğŸ•’ PrÃ³ximas Citas</h2>
      
      <div class="appointments-list">
        <div class="appointment-item" *ngFor="let apt of upcomingAppointments">
          <div class="apt-time">
            <span class="date">{{ apt.date }}</span>
            <span class="time">{{ apt.time }}</span>
          </div>
          <div class="apt-details">
            <h4>{{ apt.professional || apt.patient }}</h4>
            <p>{{ apt.specialty || apt.reason }}</p>
          </div>
          <div class="apt-status" [class]="apt.status">{{ apt.status }}</div>
        </div>
        
        <div class="no-appointments" *ngIf="!upcomingAppointments?.length">
          <div class="empty-icon">ğŸ“…</div>
          <p>No tienes citas prÃ³ximas</p>
          <button class="btn-schedule" routerLink="/app/my-appointments">Ver Mis Turnos</button>
        </div>
      </div>
    </div>
  </div>
</div>